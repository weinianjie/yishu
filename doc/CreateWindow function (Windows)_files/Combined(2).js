epx=window.epx||{};epx.communityContent=function(){function loadComments(){var $communityComments=$("#CommunityComments"),communityContentAddLink;$communityComments&&$communityComments.length!==0&&(communityContentAddLink=$(".communityContentAddLink"),$communityComments.html(""),window.epx.utilities.log("Loading comments..."),$.ajax({type:"GET",async:!0,url:$communityComments.attr("data-url"),dataType:"json",cache:!1,success:function(r){if(!r||r.length<1){window.epx.utilities.log("Comment web service returned 0 comments.");communityContentAddLink.length<1&&$(".communityContentHeaderTitle").css("display","none");return}window.epx.utilities.log("Comment web service returned "+r.length+" comment(s)...");$("#CommentTemplate").tmpl(r).appendTo($communityComments)}}))}return{loadComments:loadComments}}();$("#CommunityComments").ready(function(){epx.communityContent.loadComments()});;
epx=window.epx||{};epx.feedbackLayout=function(){function init(){hidePageFeedback();$yesNoSection=$(".feedbackContainer #feedbackSection1");$yesSection=$(".feedbackContainer #feedbackSection2");$yesRadio=$(".feedbackContainer #feedbackYes");$noSection=$(".feedbackContainer #feedbackSection3");$noRadio=$(".feedbackContainer #feedbackNo");$submitSection=$(".feedbackContainer #feedbackSection4");$feedbackText=$(".feedbackContainer #feedbackSection4 textarea");$submitButton=$(".feedbackContainer #feedbackSubmit");$thankYouSection=$(".feedbackContainer #feedbackSection5");$feedbackRadioValue=$(".feedbackContainer #feedbackValue");$feedbackUrl=$("#ratingSubmitUrl");toggleRatingEnablement();setupEventHandlers()}function toggleRatingEnablement(){$("#isTopicRated").val()==="true"&&showSections([$thankYouSection])}function hidePageFeedback(){var $feedback=$("#contentFeedback");$feedback.length&&($feedback.before($("<p><\/p>").css("padding","15px 0").css("margin","0")),$feedback.remove())}function setupEventHandlers(){$yesRadio.click(function(e){$feedbackRadioValue.val(yesRating);showSections([$yesNoSection,$yesSection,$submitSection])});$noRadio.click(function(e){$feedbackRadioValue.val(noRating);showSections([$yesNoSection,$noSection,$submitSection])});var tellUsMoreText=$(".feedbackContainer #tellUsMoreText").val(),maxChars=$(".feedbackContainer #maxTextBoxCharacters").val();$(".feedbackContainer #feedbackTextArea").focus(function(){watermarkFocus($(this),tellUsMoreText,"TellUsMoreTextBoxSearch")}).blur(function(){watermarkBlur($(this),tellUsMoreText,"TellUsMoreTextBoxSearchLoaded")}).on("mouseover keydown keyup",function(){textBoxCharactersCounter($(this),$(".feedbackContainer #feedbackTextCounter"),maxChars)});$submitButton.click(function(e){watermarkOnSubmit($feedbackText,tellUsMoreText,"TellUsMoreTextBoxSearch");submitRating($feedbackText.val())})}function showSections($sections){$yesNoSection.hide();$yesSection.hide();$noSection.hide();$submitSection.hide();$thankYouSection.hide();$($sections).each(function(idx){$(this).show()})}function watermarkFocus(control,defaultValue,cssValue){control.val()==defaultValue&&(control.val(""),control.attr("class",cssValue));$(document).unbind("keydown")}function watermarkBlur(control,defaultValue,cssValue){control.val()==""&&(control.val(defaultValue),control.attr("class",cssValue))}function watermarkOnSubmit(control,defaultValue,cssValue){control.val()==defaultValue&&(control.val(""),control.attr("class",cssValue))}function textBoxCharactersCounter(control,counter,max){control.val().length>max?control.val(control.val().substring(0,max)):counter.html((max-control.val().length).toString())}function submitRating(text){var data,chkbxNo,url;$submitButton.attr("disabled","disabled");data={__RequestVerificationToken:$("input[name='__RequestVerificationToken']").last().val(),rdIsUseful:$feedbackRadioValue.val(),feedbackText:text,returnUrl:window.location.href,isAsync:!0};chkbxNo=[];$(".feedbackContainer input[name='chkbxNo']").each(function(){chkbxNo.push($(this).val())});chkbxNo.length>0&&(data.chkbxNo=chkbxNo.join(","));url=$feedbackUrl.val();$.ajax({type:"POST",url:url,data:data,async:!0,success:function(){epx.utilities.log("Rating successfully submitted");showSections([$thankYouSection])},error:function(response){epx.utilities.log("Rating submission failed: HTTP "+response.status);showSections([$thankYouSection])}})}var yesRating=1,noRating=0,$yesNoSection,$yesSection,$yesRadio,$noSection,$noRadio,$submitSection,$feedbackText,$submitButton,$thankYouSection,$feedbackRadioValue,$feedbackUrl;return{init:init}}();$(document).ready(function(){epx.feedbackLayout.init()});;
epx=window.epx||{};epx.codeSnippetModule=function(w,d){function init(){scrollOnLoad();initCopyLinks()}function initCopyLinks(){w.clipboardData&&$("a[name=CodeSnippetCopyLink]").css("display","block")}function copyCode(id){if(w.clipboardData){var obj=d.getElementById(id);w.clipboardData.setData("Text",obj.innerText)}}function scrollOnLoad(){var hash=location.hash,hashY;hash.length>1&&hash.substr(1,1)==="Y"&&(hashY=Number(hash.substr(2)),isNaN(hashY)||w.scrollTo(0,hashY))}return{init:init,initCopyLinks:initCopyLinks,copyCode:copyCode,scrollOnLoad:scrollOnLoad}};epx.codeSnippet=epx.codeSnippetModule(window,document);$(document).ready(function(){epx.codeSnippet.init()});;
function TopicNotInScope_ShowPicker(){var topicNotInScopePicker=document.getElementById("topicNotInScopeCollectionPicker");topicNotInScopePicker&&(topicNotInScopePicker.style.display=topicNotInScopePicker.style.display!="block"?"block":"none")}function TopicNotInScope_HidePicker(e){var topicNotInScopePicker=document.getElementById("topicNotInScopeCollectionPicker"),src,e;topicNotInScopePicker&&(e=e||window.event,e.target?src=e.target:e.srcElement&&(src=e.srcElement),src.tagName=="A"&&src.parentNode.parentNode&&src.parentNode.parentNode.id=="topicNotInScopeCollectionPicker"||src.id=="topicNotInScopeSwitchCollection"||src.id=="topicNotInScopeDropdownImage"||src.id=="topicNotInScopeSwitchCollectionContainer"||topicNotInScopePicker.style.display!="block"||(topicNotInScopePicker.style.display="none"))}document.addEventListener?document.addEventListener("mouseup",TopicNotInScope_HidePicker,!1):document.attachEvent&&document.attachEvent("onmouseup",TopicNotInScope_HidePicker);;
(typeof(window.MTPS==="undefined")||typeof(window.MTPS.CollapsibleAreas==="undefined"))&&$("a.LW_CollapsibleArea_TitleAhref").live("click",function(){var $this=$(this),$image=$this.children("span").first(),$content=$this.parent().parent().next(),stringsAvailable;$image&&$content&&($this.removeAttr("title"),stringsAvailable=typeof window.MTPS!="undefined"&&typeof window.MTPS.LocalizedStrings!="undefined",$content.attr("class")==="sectionblock"?($image.attr("class","cl_CollapsibleArea_collapsing LW_CollapsibleArea_Img"),$content.attr("class","sectionnone"),stringsAvailable===!0&&$this.attr("title",window.MTPS.LocalizedStrings.ExpandButtonTooltip)):($image.attr("class","cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"),$content.attr("class","sectionblock"),stringsAvailable===!0&&$this.attr("title",window.MTPS.LocalizedStrings.CollapseButtonTooltip)))});;
epx=window.epx||{};epx.versionSelector=function(){function init(){$link&&$arrow&&$list&&($link.live("click",function(){epx.versionSelector.open()}),$arrow.live("click",function(){epx.versionSelector.open()}),$(document).live("mouseup",function(){epx.versionSelector.close()}))}function open(){$list.show()}function close(){$list.hide()}var $link=$("#vsLink"),$arrow=$("#vsArrow"),$list=$("#vsPanel");return{init:init,open:open,close:close}}();$(document).ready(function(){epx.versionSelector.init()});;
var isMetroIE10=navigator.userAgent.indexOf("MSIE 10.0")!=-1&&window.innerWidth==screen.width&&window.innerHeight==screen.height,brokerScript;isMetroIE10||(brokerScript=document.createElement("script"),brokerScript.src="//js.microsoft.com/library/svy/sto/broker.js",document.getElementsByTagName("head")[0].appendChild(brokerScript));;
